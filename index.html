<canvas id="ctx" width="500" height="500" style="border:1px solid #000000;"></canvas>

<script>
    var ctx = document.getElementById("ctx").getContext("2d");
    ctx.font = '30px Arial';

    var HEIGHT = 500;
    var WIDTH = 500;
    var message = "1"

    var player = {
        x: 50,
        spdX: 30,
        y: 40,
        spdY: 5,
        name: 'P',
        sizex: 20,
        sizey: 40,
        color: 'green',
        hp: 10,
    };

    var trafficList = {};

    getDistanceBetweenEntity = function (entity1, entity2) {
        var vx = entity1.x - entity2.x;
        var vy = entity1.y - entity2.y;
        return Math.sqrt(vx * vx + vy * vy);
    }

    testCollisionEntity = function (entity1, entity2) {
        var dist = getDistanceBetweenEntity(entity1, entity2);
        return dist < 40;
    }

    Traffic = function(id, x, y, spdX, spdY, sizex, sizey) {
        var traffic = {
            x: x,
            spdX: spdX,
            y: y,
            spdY: spdY,
            name: 'T',
            id: id,
            sizex: sizex,
            sizey: sizey,
            color: 'red',
        };
        trafficList[id] = traffic;
    }

    updateEntity = function (arg) {
        updateEntityPosition(arg);
        drawEntity(arg);
    }

    updateEntityPosition = function(arg){
        arg.x += arg.spdX;
        arg.y += arg.spdY;
       
        if (arg.x < 0 || arg.x > WIDTH) {
            arg.spdX = -arg.spdX;
        }
        if (arg.y < 0 || arg.y > HEIGHT) {
            arg.spdY = -arg.spdY;
        }
    }

    drawEntity = function(arg){
         ctx.fillStyle=arg.color;
         ctx.fillRect(arg.x, arg.y, arg.sizex, arg.sizey);
    }
    update = function(){
        ctx.clearRect(0, 0, WIDTH, HEIGHT);

        for (var key in trafficList) {
            updateEntity(trafficList[key]);

            var isColliding = testCollisionEntity(player, trafficList[key]);
            if (isColliding) {
                player.hp = player.hp - 1;
                if(player.hp <= 0){
                    console.log('you lost!');
                }
            }
        }

        updateEntity(player);
        ctx.fillText(player.hp + ' hp',0,30);
    }

    Traffic('T1', 300, 0, 0, 5, 20, 40);
    Traffic('T2', 160, 0, 0, 10, 20, 40);
    Traffic('T3', 230, 0, 0, 7, 20, 40);

    setInterval(update, 40);

</script>